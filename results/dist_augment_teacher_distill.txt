--- Pre-training a teacher model on the full dataset ---

--- Starting training for 50 epochs with LR=0.02 ---
Epoch 1/50: 100%|██████████| 196/196 [00:08<00:00, 23.16it/s, loss=1.7134]
Epoch 2/50: 100%|██████████| 196/196 [00:07<00:00, 26.31it/s, loss=1.3595]
Epoch 3/50: 100%|██████████| 196/196 [00:07<00:00, 26.23it/s, loss=1.1857]
Epoch 4/50: 100%|██████████| 196/196 [00:07<00:00, 25.90it/s, loss=1.0534]
Epoch 5/50: 100%|██████████| 196/196 [00:07<00:00, 25.59it/s, loss=0.9884]
Epoch 6/50: 100%|██████████| 196/196 [00:07<00:00, 25.11it/s, loss=0.9109]
Epoch 7/50: 100%|██████████| 196/196 [00:07<00:00, 24.72it/s, loss=0.8592]
Epoch 8/50: 100%|██████████| 196/196 [00:07<00:00, 24.63it/s, loss=0.8137]
Epoch 9/50: 100%|██████████| 196/196 [00:07<00:00, 24.86it/s, loss=0.7675]
Epoch 10/50: 100%|██████████| 196/196 [00:07<00:00, 25.24it/s, loss=0.7386]
Epoch 11/50: 100%|██████████| 196/196 [00:07<00:00, 25.61it/s, loss=0.7063]
Epoch 12/50: 100%|██████████| 196/196 [00:07<00:00, 25.71it/s, loss=0.6779]
Epoch 13/50: 100%|██████████| 196/196 [00:07<00:00, 25.83it/s, loss=0.6450]
Epoch 14/50: 100%|██████████| 196/196 [00:07<00:00, 25.73it/s, loss=0.6301]
Epoch 15/50: 100%|██████████| 196/196 [00:07<00:00, 25.67it/s, loss=0.6113]
Epoch 16/50: 100%|██████████| 196/196 [00:07<00:00, 25.49it/s, loss=0.5832]
Epoch 17/50: 100%|██████████| 196/196 [00:07<00:00, 25.20it/s, loss=0.5663]
Epoch 18/50: 100%|██████████| 196/196 [00:07<00:00, 25.36it/s, loss=0.5512]
Epoch 19/50: 100%|██████████| 196/196 [00:07<00:00, 25.24it/s, loss=0.5291]
Epoch 20/50: 100%|██████████| 196/196 [00:07<00:00, 25.30it/s, loss=0.5116]
Epoch 21/50: 100%|██████████| 196/196 [00:07<00:00, 25.30it/s, loss=0.5043]
Epoch 22/50: 100%|██████████| 196/196 [00:07<00:00, 25.43it/s, loss=0.4790]
Epoch 23/50: 100%|██████████| 196/196 [00:07<00:00, 25.43it/s, loss=0.4639]
Epoch 24/50: 100%|██████████| 196/196 [00:07<00:00, 25.40it/s, loss=0.4479]
Epoch 25/50: 100%|██████████| 196/196 [00:07<00:00, 25.55it/s, loss=0.4378]
Epoch 26/50: 100%|██████████| 196/196 [00:07<00:00, 25.54it/s, loss=0.4214]
Epoch 27/50: 100%|██████████| 196/196 [00:07<00:00, 25.58it/s, loss=0.4033]
Epoch 28/50: 100%|██████████| 196/196 [00:07<00:00, 25.55it/s, loss=0.3907]
Epoch 29/50: 100%|██████████| 196/196 [00:07<00:00, 25.47it/s, loss=0.3755]
Epoch 30/50: 100%|██████████| 196/196 [00:07<00:00, 25.54it/s, loss=0.3589]
Epoch 31/50: 100%|██████████| 196/196 [00:07<00:00, 25.35it/s, loss=0.3461]
Epoch 32/50: 100%|██████████| 196/196 [00:07<00:00, 25.39it/s, loss=0.3255]
Epoch 33/50: 100%|██████████| 196/196 [00:07<00:00, 25.38it/s, loss=0.3195]
Epoch 34/50: 100%|██████████| 196/196 [00:07<00:00, 25.41it/s, loss=0.3048]
Epoch 35/50: 100%|██████████| 196/196 [00:07<00:00, 25.47it/s, loss=0.2893]
Epoch 36/50: 100%|██████████| 196/196 [00:07<00:00, 25.34it/s, loss=0.2710]
Epoch 37/50: 100%|██████████| 196/196 [00:07<00:00, 25.47it/s, loss=0.2619]
Epoch 38/50: 100%|██████████| 196/196 [00:07<00:00, 25.47it/s, loss=0.2482]
Epoch 39/50: 100%|██████████| 196/196 [00:07<00:00, 25.63it/s, loss=0.2341]
Epoch 40/50: 100%|██████████| 196/196 [00:07<00:00, 25.54it/s, loss=0.2214]
Epoch 41/50: 100%|██████████| 196/196 [00:07<00:00, 25.59it/s, loss=0.2113]
Epoch 42/50: 100%|██████████| 196/196 [00:07<00:00, 25.55it/s, loss=0.2006]
Epoch 43/50: 100%|██████████| 196/196 [00:07<00:00, 25.56it/s, loss=0.1939]
Epoch 44/50: 100%|██████████| 196/196 [00:07<00:00, 25.66it/s, loss=0.1851]
Epoch 45/50: 100%|██████████| 196/196 [00:07<00:00, 25.59it/s, loss=0.1770]
Epoch 46/50: 100%|██████████| 196/196 [00:07<00:00, 25.46it/s, loss=0.1707]
Epoch 47/50: 100%|██████████| 196/196 [00:07<00:00, 25.63it/s, loss=0.1675]
Epoch 48/50: 100%|██████████| 196/196 [00:07<00:00, 25.51it/s, loss=0.1657]
Epoch 49/50: 100%|██████████| 196/196 [00:07<00:00, 25.60it/s, loss=0.1653]
Epoch 50/50: 100%|██████████| 196/196 [00:07<00:00, 25.52it/s, loss=0.1632]
Accuracy of the model No Distillation: 83.58 %

--- Running the Coreset distillation process ---
Extracting features: 100%|██████████| 196/196 [00:03<00:00, 63.87it/s]
Finding prototypes per class: 100%|██████████| 10/10 [00:53<00:00,  5.33s/it]

Distilled coreset size: 5000


===== EXPERIMENT 1: TRAINING ON CORESET WITHOUT AUGMENTATION =====

--- Starting training for 50 epochs with LR=0.02 ---
Epoch 1/50: 100%|██████████| 20/20 [00:00<00:00, 21.34it/s, loss=2.0658]
Epoch 2/50: 100%|██████████| 20/20 [00:00<00:00, 23.79it/s, loss=1.6220]
Epoch 3/50: 100%|██████████| 20/20 [00:00<00:00, 23.91it/s, loss=1.3494]
Epoch 4/50: 100%|██████████| 20/20 [00:00<00:00, 23.75it/s, loss=0.9643]
Epoch 5/50: 100%|██████████| 20/20 [00:00<00:00, 23.90it/s, loss=0.7037]
Epoch 6/50: 100%|██████████| 20/20 [00:00<00:00, 23.56it/s, loss=0.5426]
Epoch 7/50: 100%|██████████| 20/20 [00:00<00:00, 23.48it/s, loss=0.4705]
Epoch 8/50: 100%|██████████| 20/20 [00:00<00:00, 23.61it/s, loss=0.3648]
Epoch 9/50: 100%|██████████| 20/20 [00:00<00:00, 23.49it/s, loss=0.2794]
Epoch 10/50: 100%|██████████| 20/20 [00:00<00:00, 23.52it/s, loss=0.1921]
Epoch 11/50: 100%|██████████| 20/20 [00:00<00:00, 23.55it/s, loss=0.1234]
Epoch 12/50: 100%|██████████| 20/20 [00:00<00:00, 23.41it/s, loss=0.0944]
Epoch 13/50: 100%|██████████| 20/20 [00:00<00:00, 23.68it/s, loss=0.0545]
Epoch 14/50: 100%|██████████| 20/20 [00:00<00:00, 23.17it/s, loss=0.0326]
Epoch 15/50: 100%|██████████| 20/20 [00:00<00:00, 22.48it/s, loss=0.0184]
Epoch 16/50: 100%|██████████| 20/20 [00:00<00:00, 22.93it/s, loss=0.0111]
Epoch 17/50: 100%|██████████| 20/20 [00:00<00:00, 23.19it/s, loss=0.0067]
Epoch 18/50: 100%|██████████| 20/20 [00:00<00:00, 23.03it/s, loss=0.0036]
Epoch 19/50: 100%|██████████| 20/20 [00:00<00:00, 23.28it/s, loss=0.0016]
Epoch 20/50: 100%|██████████| 20/20 [00:00<00:00, 23.16it/s, loss=0.0010]
Epoch 21/50: 100%|██████████| 20/20 [00:00<00:00, 22.93it/s, loss=0.0006]
Epoch 22/50: 100%|██████████| 20/20 [00:00<00:00, 23.09it/s, loss=0.0005]
Epoch 23/50: 100%|██████████| 20/20 [00:00<00:00, 23.09it/s, loss=0.0005]
Epoch 24/50: 100%|██████████| 20/20 [00:00<00:00, 22.99it/s, loss=0.0005]
Epoch 25/50: 100%|██████████| 20/20 [00:00<00:00, 22.75it/s, loss=0.0004]
Epoch 26/50: 100%|██████████| 20/20 [00:00<00:00, 22.94it/s, loss=0.0004]
Epoch 27/50: 100%|██████████| 20/20 [00:00<00:00, 22.77it/s, loss=0.0004]
Epoch 28/50: 100%|██████████| 20/20 [00:00<00:00, 22.78it/s, loss=0.0004]
Epoch 29/50: 100%|██████████| 20/20 [00:00<00:00, 22.54it/s, loss=0.0004]
Epoch 30/50: 100%|██████████| 20/20 [00:00<00:00, 21.68it/s, loss=0.0003]
Epoch 31/50: 100%|██████████| 20/20 [00:00<00:00, 22.77it/s, loss=0.0004]
Epoch 32/50: 100%|██████████| 20/20 [00:00<00:00, 22.59it/s, loss=0.0003]
Epoch 33/50: 100%|██████████| 20/20 [00:00<00:00, 22.58it/s, loss=0.0004]
Epoch 34/50: 100%|██████████| 20/20 [00:00<00:00, 22.13it/s, loss=0.0003]
Epoch 35/50: 100%|██████████| 20/20 [00:00<00:00, 22.52it/s, loss=0.0004]
Epoch 36/50: 100%|██████████| 20/20 [00:00<00:00, 22.71it/s, loss=0.0003]
Epoch 37/50: 100%|██████████| 20/20 [00:00<00:00, 22.81it/s, loss=0.0003]
Epoch 38/50: 100%|██████████| 20/20 [00:00<00:00, 22.71it/s, loss=0.0003]
Epoch 39/50: 100%|██████████| 20/20 [00:00<00:00, 22.90it/s, loss=0.0004]
Epoch 40/50: 100%|██████████| 20/20 [00:00<00:00, 22.96it/s, loss=0.0003]
Epoch 41/50: 100%|██████████| 20/20 [00:00<00:00, 22.86it/s, loss=0.0003]
Epoch 42/50: 100%|██████████| 20/20 [00:00<00:00, 22.71it/s, loss=0.0004]
Epoch 43/50: 100%|██████████| 20/20 [00:00<00:00, 22.99it/s, loss=0.0003]
Epoch 44/50: 100%|██████████| 20/20 [00:00<00:00, 22.79it/s, loss=0.0003]
Epoch 45/50: 100%|██████████| 20/20 [00:00<00:00, 22.95it/s, loss=0.0003]
Epoch 46/50: 100%|██████████| 20/20 [00:00<00:00, 23.27it/s, loss=0.0003]
Epoch 47/50: 100%|██████████| 20/20 [00:00<00:00, 23.22it/s, loss=0.0003]
Epoch 48/50: 100%|██████████| 20/20 [00:00<00:00, 23.34it/s, loss=0.0003]
Epoch 49/50: 100%|██████████| 20/20 [00:00<00:00, 23.36it/s, loss=0.0003]
Epoch 50/50: 100%|██████████| 20/20 [00:00<00:00, 23.25it/s, loss=0.0003]
Accuracy of the model on Coreset WITHOUT augmentation: 51.28 %


===== EXPERIMENT 2: TRAINING ON CORESET WITH AUGMENTATION =====

--- Starting training for 50 epochs with LR=0.02 ---
Epoch 1/50: 100%|██████████| 20/20 [00:00<00:00, 22.13it/s, loss=2.2285]
Epoch 2/50: 100%|██████████| 20/20 [00:00<00:00, 22.07it/s, loss=1.9099]
Epoch 3/50: 100%|██████████| 20/20 [00:00<00:00, 22.31it/s, loss=1.7189]
Epoch 4/50: 100%|██████████| 20/20 [00:00<00:00, 22.09it/s, loss=1.5983]
Epoch 5/50: 100%|██████████| 20/20 [00:00<00:00, 22.01it/s, loss=1.5115]
Epoch 6/50: 100%|██████████| 20/20 [00:00<00:00, 22.04it/s, loss=1.4506]
Epoch 7/50: 100%|██████████| 20/20 [00:00<00:00, 22.09it/s, loss=1.4260]
Epoch 8/50: 100%|██████████| 20/20 [00:00<00:00, 22.37it/s, loss=1.3823]
Epoch 9/50: 100%|██████████| 20/20 [00:00<00:00, 22.34it/s, loss=1.3234]
Epoch 10/50: 100%|██████████| 20/20 [00:00<00:00, 22.32it/s, loss=1.2712]
Epoch 11/50: 100%|██████████| 20/20 [00:00<00:00, 22.43it/s, loss=1.2223]
Epoch 12/50: 100%|██████████| 20/20 [00:00<00:00, 22.52it/s, loss=1.1913]
Epoch 13/50: 100%|██████████| 20/20 [00:00<00:00, 22.51it/s, loss=1.1723]
Epoch 14/50: 100%|██████████| 20/20 [00:00<00:00, 22.60it/s, loss=1.1558]
Epoch 15/50: 100%|██████████| 20/20 [00:00<00:00, 22.23it/s, loss=1.0971]
Epoch 16/50: 100%|██████████| 20/20 [00:00<00:00, 22.59it/s, loss=1.0468]
Epoch 17/50: 100%|██████████| 20/20 [00:00<00:00, 22.42it/s, loss=1.0178]
Epoch 18/50: 100%|██████████| 20/20 [00:00<00:00, 21.53it/s, loss=0.9795]
Epoch 19/50: 100%|██████████| 20/20 [00:00<00:00, 20.91it/s, loss=0.9554]
Epoch 20/50: 100%|██████████| 20/20 [00:00<00:00, 22.26it/s, loss=0.9184]
Epoch 21/50: 100%|██████████| 20/20 [00:00<00:00, 22.65it/s, loss=0.8711]
Epoch 22/50: 100%|██████████| 20/20 [00:00<00:00, 22.46it/s, loss=0.8336]
Epoch 23/50: 100%|██████████| 20/20 [00:00<00:00, 22.54it/s, loss=0.8123]
Epoch 24/50: 100%|██████████| 20/20 [00:00<00:00, 22.54it/s, loss=0.7447]
Epoch 25/50: 100%|██████████| 20/20 [00:00<00:00, 22.50it/s, loss=0.7367]
Epoch 26/50: 100%|██████████| 20/20 [00:00<00:00, 22.56it/s, loss=0.7030]
Epoch 27/50: 100%|██████████| 20/20 [00:00<00:00, 22.38it/s, loss=0.6499]
Epoch 28/50: 100%|██████████| 20/20 [00:00<00:00, 22.24it/s, loss=0.6136]
Epoch 29/50: 100%|██████████| 20/20 [00:00<00:00, 22.58it/s, loss=0.5848]
Epoch 30/50: 100%|██████████| 20/20 [00:00<00:00, 22.48it/s, loss=0.5567]
Epoch 31/50: 100%|██████████| 20/20 [00:00<00:00, 21.89it/s, loss=0.5237]
Epoch 32/50: 100%|██████████| 20/20 [00:00<00:00, 22.15it/s, loss=0.5127]
Epoch 33/50: 100%|██████████| 20/20 [00:00<00:00, 20.78it/s, loss=0.4704]
Epoch 34/50: 100%|██████████| 20/20 [00:00<00:00, 22.68it/s, loss=0.4401]
Epoch 35/50: 100%|██████████| 20/20 [00:00<00:00, 22.60it/s, loss=0.4292]
Epoch 36/50: 100%|██████████| 20/20 [00:00<00:00, 22.25it/s, loss=0.3977]
Epoch 37/50: 100%|██████████| 20/20 [00:00<00:00, 22.63it/s, loss=0.3660]
Epoch 38/50: 100%|██████████| 20/20 [00:00<00:00, 22.71it/s, loss=0.3429]
Epoch 39/50: 100%|██████████| 20/20 [00:00<00:00, 22.62it/s, loss=0.3160]
Epoch 40/50: 100%|██████████| 20/20 [00:00<00:00, 22.50it/s, loss=0.2995]
Epoch 41/50: 100%|██████████| 20/20 [00:00<00:00, 22.31it/s, loss=0.2811]
Epoch 42/50: 100%|██████████| 20/20 [00:00<00:00, 22.31it/s, loss=0.2647]
Epoch 43/50: 100%|██████████| 20/20 [00:00<00:00, 22.37it/s, loss=0.2543]
Epoch 44/50: 100%|██████████| 20/20 [00:00<00:00, 22.49it/s, loss=0.2619]
Epoch 45/50: 100%|██████████| 20/20 [00:00<00:00, 21.70it/s, loss=0.2423]
Epoch 46/50: 100%|██████████| 20/20 [00:00<00:00, 21.76it/s, loss=0.2362]
Epoch 47/50: 100%|██████████| 20/20 [00:00<00:00, 22.12it/s, loss=0.2379]
Epoch 48/50: 100%|██████████| 20/20 [00:00<00:00, 22.40it/s, loss=0.2382]
Epoch 49/50: 100%|██████████| 20/20 [00:00<00:00, 22.14it/s, loss=0.2255]
Epoch 50/50: 100%|██████████| 20/20 [00:00<00:00, 22.20it/s, loss=0.2237]
Accuracy of the model on Coreset WITH augmentation: 56.89 %


===== EXPERIMENT 3: TRAINING ON CORESET WITH KNOWLEDGE DISTILLATION =====

Initialized Knowledge Distillation Trainer with alpha=0.1, temp=4.0

--- Starting Knowledge Distillation training for 50 epochs with LR=0.02 ---
Epoch 1/50: 100%|██████████| 20/20 [00:01<00:00, 17.15it/s, loss=12.2760]
Epoch 2/50: 100%|██████████| 20/20 [00:01<00:00, 18.67it/s, loss=9.9716]
Epoch 3/50: 100%|██████████| 20/20 [00:01<00:00, 18.62it/s, loss=8.8745]
Epoch 4/50: 100%|██████████| 20/20 [00:01<00:00, 18.47it/s, loss=7.9289]
Epoch 5/50: 100%|██████████| 20/20 [00:01<00:00, 18.46it/s, loss=7.5234]
Epoch 6/50: 100%|██████████| 20/20 [00:01<00:00, 18.31it/s, loss=7.1366]
Epoch 7/50: 100%|██████████| 20/20 [00:01<00:00, 18.33it/s, loss=6.5735]
Epoch 8/50: 100%|██████████| 20/20 [00:01<00:00, 18.39it/s, loss=6.1392]
Epoch 9/50: 100%|██████████| 20/20 [00:01<00:00, 18.49it/s, loss=6.1272]
Epoch 10/50: 100%|██████████| 20/20 [00:01<00:00, 18.54it/s, loss=5.5865]
Epoch 11/50: 100%|██████████| 20/20 [00:01<00:00, 18.32it/s, loss=5.2557]
Epoch 12/50: 100%|██████████| 20/20 [00:01<00:00, 18.33it/s, loss=5.1023]
Epoch 13/50: 100%|██████████| 20/20 [00:01<00:00, 18.43it/s, loss=4.9331]
Epoch 14/50: 100%|██████████| 20/20 [00:01<00:00, 18.22it/s, loss=4.5209]
Epoch 15/50: 100%|██████████| 20/20 [00:01<00:00, 18.37it/s, loss=4.3237]
Epoch 16/50: 100%|██████████| 20/20 [00:01<00:00, 18.38it/s, loss=4.1947]
Epoch 17/50: 100%|██████████| 20/20 [00:01<00:00, 18.23it/s, loss=3.8564]
Epoch 18/50: 100%|██████████| 20/20 [00:01<00:00, 18.21it/s, loss=3.7548]
Epoch 19/50: 100%|██████████| 20/20 [00:01<00:00, 18.23it/s, loss=3.5173]
Epoch 20/50: 100%|██████████| 20/20 [00:01<00:00, 18.32it/s, loss=3.3950]
Epoch 21/50: 100%|██████████| 20/20 [00:01<00:00, 18.42it/s, loss=3.2666]
Epoch 22/50: 100%|██████████| 20/20 [00:01<00:00, 18.24it/s, loss=2.9904]
Epoch 23/50: 100%|██████████| 20/20 [00:01<00:00, 18.28it/s, loss=3.0126]
Epoch 24/50: 100%|██████████| 20/20 [00:01<00:00, 18.41it/s, loss=2.8258]
Epoch 25/50: 100%|██████████| 20/20 [00:01<00:00, 18.37it/s, loss=2.6055]
Epoch 26/50: 100%|██████████| 20/20 [00:01<00:00, 18.46it/s, loss=2.5152]
Epoch 27/50: 100%|██████████| 20/20 [00:01<00:00, 18.36it/s, loss=2.4103]
Epoch 28/50: 100%|██████████| 20/20 [00:01<00:00, 18.17it/s, loss=2.3581]
Epoch 29/50: 100%|██████████| 20/20 [00:01<00:00, 18.30it/s, loss=2.2750]
Epoch 30/50: 100%|██████████| 20/20 [00:01<00:00, 18.25it/s, loss=2.1315]
Epoch 31/50: 100%|██████████| 20/20 [00:01<00:00, 18.45it/s, loss=2.0323]
Epoch 32/50: 100%|██████████| 20/20 [00:01<00:00, 18.51it/s, loss=1.9695]
Epoch 33/50: 100%|██████████| 20/20 [00:01<00:00, 18.44it/s, loss=1.9188]
Epoch 34/50: 100%|██████████| 20/20 [00:01<00:00, 18.31it/s, loss=1.8442]
Epoch 35/50: 100%|██████████| 20/20 [00:01<00:00, 18.51it/s, loss=1.7935]
Epoch 36/50: 100%|██████████| 20/20 [00:01<00:00, 18.51it/s, loss=1.7012]
Epoch 37/50: 100%|██████████| 20/20 [00:01<00:00, 18.28it/s, loss=1.6667]
Epoch 38/50: 100%|██████████| 20/20 [00:01<00:00, 18.23it/s, loss=1.6212]
Epoch 39/50: 100%|██████████| 20/20 [00:01<00:00, 18.30it/s, loss=1.6070]
Epoch 40/50: 100%|██████████| 20/20 [00:01<00:00, 18.42it/s, loss=1.5690]
Epoch 41/50: 100%|██████████| 20/20 [00:01<00:00, 18.46it/s, loss=1.5311]
Epoch 42/50: 100%|██████████| 20/20 [00:01<00:00, 18.52it/s, loss=1.5237]
Epoch 43/50: 100%|██████████| 20/20 [00:01<00:00, 18.54it/s, loss=1.4586]
Epoch 44/50: 100%|██████████| 20/20 [00:01<00:00, 18.46it/s, loss=1.4741]
Epoch 45/50: 100%|██████████| 20/20 [00:01<00:00, 18.66it/s, loss=1.4512]
Epoch 46/50: 100%|██████████| 20/20 [00:01<00:00, 18.45it/s, loss=1.4412]
Epoch 47/50: 100%|██████████| 20/20 [00:01<00:00, 18.50it/s, loss=1.4497]
Epoch 48/50: 100%|██████████| 20/20 [00:01<00:00, 18.41it/s, loss=1.4297]
Epoch 49/50: 100%|██████████| 20/20 [00:01<00:00, 18.61it/s, loss=1.4402]
Epoch 50/50: 100%|██████████| 20/20 [00:01<00:00, 18.31it/s, loss=1.4101]
Accuracy of the model on Coreset WITH Knowledge Distillation: 70.21 %


========== FINAL COMPARISON ==========
Accuracy WITHOUT distillation: 83.58 %
Accuracy WITHOUT augmentation: 51.28 %
Accuracy WITH augmentation:    56.89 %
Accuracy WITH Knowledge Distillation: 70.21 %
======================================